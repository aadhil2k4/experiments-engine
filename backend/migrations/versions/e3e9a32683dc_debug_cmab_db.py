"""debug cmab db

Revision ID: e3e9a32683dc
Revises: e79baca70383
Create Date: 2025-02-27 17:51:30.826300

"""

from typing import Sequence, Union

import sqlalchemy as sa
from alembic import op
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision: str = "e3e9a32683dc"
down_revision: Union[str, None] = "e79baca70383"
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column(
        "contextual_arms", sa.Column("mu", postgresql.ARRAY(sa.Float()), nullable=False)
    )
    op.add_column(
        "contextual_arms",
        sa.Column("covariance", postgresql.ARRAY(sa.Float()), nullable=False),
    )
    op.drop_column("contextual_arms", "_mu")
    op.drop_column("contextual_arms", "_covariance")
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column(
        "contextual_arms",
        sa.Column(
            "_covariance",
            postgresql.ARRAY(sa.DOUBLE_PRECISION(precision=53)),
            autoincrement=False,
            nullable=False,
        ),
    )
    op.add_column(
        "contextual_arms",
        sa.Column(
            "_mu",
            postgresql.ARRAY(sa.DOUBLE_PRECISION(precision=53)),
            autoincrement=False,
            nullable=False,
        ),
    )
    op.drop_column("contextual_arms", "covariance")
    op.drop_column("contextual_arms", "mu")
    # ### end Alembic commands ###
